<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>Nuevo Usuario</title>
        <h:outputStylesheet library="css" name="bootstrap.min.css"/>
        <h:outputStylesheet library="css" name="all.min.css"/>
        <h:outputStylesheet library="css" name="styles.css" />
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                var newUserNameInput = document.getElementById('newUserForm:newUserName');
                if (newUserNameInput) {
                    newUserNameInput.addEventListener('input', function (e) {
                        this.value = this.value.replace(/[^A-Za-zÁÉÍÓÚáéíóúÑñ\s]/g, '');
                    });
                }
                var newUserPhoneInput = document.getElementById('newUserForm:newUserPhone');
                if (newUserPhoneInput) {
                    newUserPhoneInput.addEventListener('input', function (e) {
                        this.value = this.value.replace(/[^0-9]/g, '');
                    });
                }
            });
        </script>
    </h:head>
    <h:body>
        <div class="header">
            <div>Nuevo Usuario</div>
            <div class="header-right">
                <h:form>
                    <h:commandLink value="Volver" action="mainPage.xhtml?faces-redirect=true" class="btn-logout"/>
                </h:form>
            </div>
        </div>

        <div class="detail-container">
            <div class="header-form">Crear Nuevo Usuario</div>

            <h:form id="newUserForm">
                <!-- INFORMACIÓN PERSONAL -->
                <div class="form-section">
                    <h3>Información Personal</h3>
                    <div class="form-group">
                        <h:outputLabel value="Nombre completo *" for="newUserName"/>
                        <h:inputText id="newUserName" value="#{userManagerBean.newUserName}" class="form-control" required="true"/>
                    </div>
                    <div class="form-group">
                        <h:outputLabel value="Correo electrónico *" for="newUserEmail"/>
                        <h:inputText id="newUserEmail" value="#{userManagerBean.newUserEmail}" class="form-control" required="true" validatorMessage="Formato de correo electrónico inválido.">
                            <f:validateRegex pattern="[\w\.-]*[a-zA-Z0-9_]@[w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]"/>
                        </h:inputText>
                        <h:message for="newUserEmail" style="color: red;"/>
                    </div>
                    <div class="form-group">
                        <h:outputLabel value="Teléfono *" for="newUserPhone"/>
                        <h:inputText id="newUserPhone" value="#{userManagerBean.newUserPhone}" class="form-control" maxlength="10" required="true" validatorMessage="El teléfono debe tener 10 dígitos.">
                             <f:validateLength minimum="10" maximum="10"/>
                             <f:validateRegex pattern="^[0-9]{10}$"/>
                        </h:inputText>
                        <h:message for="newUserPhone" style="color: red;"/>
                    </div>
                </div>

                <!-- ESTADO Y ACCESO -->
                <div class="form-section">
                    <h3>Estado y Acceso</h3>
                    <div class="form-group">
                        <h:outputLabel value="Rol asignado *" for="newUserRole"/>
                        <h:selectOneMenu id="newUserRole" value="#{userManagerBean.newUserRole}" class="form-control" required="true">
                            <f:selectItem itemLabel="Seleccione..." itemValue="" noSelectionOption="true"/>
                            <f:selectItem itemLabel="Jefe" itemValue="Jefe"/>
                            <f:selectItem itemLabel="Gerente" itemValue="Gerente"/>
                            <f:selectItem itemLabel="Operador" itemValue="Operador"/>
                        </h:selectOneMenu>
                    </div>
                    <div class="form-group">
                        <h:outputLabel value="Estado de cuenta" for="newUserStatus"/>
                        <h:selectOneMenu id="newUserStatus" value="#{userManagerBean.newUserStatus}" class="form-control">
                            <f:selectItem itemLabel="Activo" itemValue="Activo"/>
                            <f:selectItem itemLabel="Inactivo" itemValue="Inactivo"/>
                        </h:selectOneMenu>
                    </div>
                    <div class="form-group">
                        <h:outputLabel value="Módulo" for="newUserModule"/>
                        <h:inputText id="newUserModule" value="#{userManagerBean.newUserModule}" class="form-control"/>
                    </div>
                </div>

                <!-- BOTONES -->
                <div class="form-actions">
                    <h:commandButton value="GUARDAR USUARIO" action="#{userManagerBean.handleNewUser}" class="btn-success-custom"/>
                    <h:commandLink value="CANCELAR" action="mainPage.xhtml?faces-redirect=true" class="btn-secondary-custom"/>
                </div>
                <h:messages globalOnly="false" style="color:red; margin-top: 10px;" infoStyle="color:green;" errorStyle="color:red;"/>
            </h:form>
        </div>
        <h:outputScript library="js" name="bootstrap.bundle.min.js"/>
    </h:body>
</html>